<section class="background-overlay" [class.hidden]="!overlayState.isActive ">
  <div class="content">
    <div class="overlay-contact">
      <div class="mobile-image">
        <img src="assets/img/add-contacts/user-image.svg" alt="" />
      </div>
      <div class="d-flex">
        <div class="add-contact">
          <div class="mobile-close" (click)="toggleOverlay()">
            <img src="assets/img/add-contacts/mobile-close.svg" />
          </div>
          <div class="center-contact">
            <img src="assets/img/add-contacts/join-logo.svg" />
            @switch (overlayState.AddOrEditState) { 
              @case ("addContact") {
                <h2>Add contact</h2>
                <span>Task are better with a team!
                  <div class="blue-line"></div>
                </span> }
              @case ("editContact") {
                <h2>Edit contact</h2>
                } }
          </div>
        </div>
        <div class="user-data">
          <div class="close-image" (click)="toggleOverlay()">
            <img src="assets/img/add-contacts/Vector.svg" />
          </div>
          <div class="user-image">
            <img src="assets/img/add-contacts/user-image.svg" />
          </div>
          <div class="user-contact-data">

            <form class="contact-form" #contactForm="ngForm">
              @switch (overlayState.AddOrEditState) {
                @case ('addContact') {
                  <input [(ngModel)]="contactList.firstName" class="user" type="text" placeholder="Name" name="name" required pattern="^([A-ZÄÖÜ][a-zäöüß'’\-]+)(?:\s+[A-ZÄÖÜ][a-zäöüß'’\-]+)?$" id="name" #name="ngModel" [class.invalid]=" name.invalid && name.dirty " />
                  @if (name.invalid && name.dirty) {
                    <div class="invalid-input">Invalid Username</div>
                  }

                  <input [(ngModel)]="contactList.email" class="mail" type="email" placeholder="Email" name="email" required pattern="[a-zA-Z0-9._%+\-]+@[a-zA-Z0-9.\-]+\.[a-zA-Z]{2,}" id="mail" #mail="ngModel" [class.invalid]=" mail.invalid && mail.dirty " />
                  @if (mail.invalid && mail.dirty) {
                    <div class="invalid-input">Invalid Email</div>
                  }

                  <input [(ngModel)]="contactList.phone" class="phone" type="tel" placeholder="Phone" name="phone" required pattern="^\+?[0-9\s]{6,25}$" id="phone" #phone="ngModel" [class.invalid]=" phone.invalid && phone.dirty " />
                  @if (phone.invalid && phone.dirty) {
                    <div class="invalid-input">Invalid Number</div>
                  }  

                }@case ('editContact') {
                  @if (overlayState.selectedUser) {
                    <input [(ngModel)]="overlayState.fullNameForEdit" class="user" type="text" placeholder="Name" name="name" required pattern="^([A-ZÄÖÜ][a-zäöüß'’\-]+)(?:\s+[A-ZÄÖÜ][a-zäöüß'’\-]+)?$" id="name" #name="ngModel" [class.invalid]=" name.invalid && name.dirty " />
                    @if (name.invalid && name.dirty) {
                      <div class="invalid-input">Invalid Username</div>
                    }

                    <input [(ngModel)]="overlayState.selectedUser.email" class="mail" type="email" placeholder="Email" name="email" required pattern="[a-zA-Z0-9._%+\-]+@[a-zA-Z0-9.\-]+\.[a-zA-Z]{2,}" id="mail" #mail="ngModel" [class.invalid]=" mail.invalid && mail.dirty " />
                    @if (mail.invalid && mail.dirty) {
                      <div class="invalid-input">Invalid Email</div>
                    }

                    <input [(ngModel)]="overlayState.selectedUser.phone" class="phone" type="tel" placeholder="Phone" name="phone" required pattern="^\+?[0-9\s]{6,25}$" id="phone" #phone="ngModel" [class.invalid]=" phone.invalid && phone.dirty " />
                    @if (phone.invalid && phone.dirty) {
                      <div class="invalid-input">Invalid Number</div>
                    }
                  }
                }
              }
            </form>

            <div class="cancel-create-contact">
              @switch (overlayState.AddOrEditState) {
              @case ("addContact") {
              <button (click)="toggleOverlay();  resetNewContactInput();" class="cancel">
                Cancel
                <img src="assets/img/add-contacts/Vector.svg" />
              </button>
              <button class="create" [disabled]="!contactForm.valid"
                (click)=" splitFullName(); overlayState.addContacts(contactList); resetNewContactInput(); toggleOverlay(); contactForm.resetForm();">
                Create contact
                <img src="assets/img/add-contacts/check.svg" />
              </button>
              } @case ("editContact") {
              <button class="cancel" >Delete</button>
              <button class="create"
                (click)="overlayState.updateContact(); resetNewContactInput(); toggleOverlay();" [disabled]="!contactForm.valid">
                Save
                <img src="assets/img/add-contacts/check.svg" />
              </button>
              } 
            }
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>